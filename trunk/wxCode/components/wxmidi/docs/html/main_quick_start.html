<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>wxMidi - A MIDI interface based on PortMidi: wxMidi quick start</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-doxygen.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">wxMidi - A MIDI interface based on PortMidi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('main_quick_start.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">wxMidi quick start </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="main_send"></a>
Sending MIDI messages</h1>
<p>Using wxMidi basically requires the following steps:</p>
<ol type="1">
<li>Access the <a class="el" href="classwxMidiSystem.html" title="Class wxMidiSystem is the entry point to the wxMidi library. ">wxMidiSystem</a> instance and look for available MIDI devices: <div class="fragment"><div class="line"><a class="code" href="classwxMidiSystem.html">wxMidiSystem</a>* pMidiSystem = <a class="code" href="classwxMidiSystem.html#adf8f17a3be75d0b8337ffce4092a9b8b">wxMidiSystem::GetInstance</a>();</div>
<div class="line"><span class="keywordtype">int</span> nMaxDevice = pMidiSystem-&gt;<a class="code" href="classwxMidiSystem.html#add8ae1f90b7275322cb6d76e7cec5ddd">CountDevices</a>();</div>
</div><!-- fragment --></li>
<li>Create an instance for the MIDI device you would like to use and open the device: <div class="fragment"><div class="line"><span class="comment">// In this example we will use the first device available </span></div>
<div class="line"><span class="comment">// (device number 0) assuming it is an output device. </span></div>
<div class="line"><span class="comment">// In your application you should use a suitable device.</span></div>
<div class="line"><span class="comment">// See wxMidiSystem::CountDevices() for an</span></div>
<div class="line"><span class="comment">// example of how to load a combo box with the available</span></div>
<div class="line"><span class="comment">// devices, so the user can choose the device to use.</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classwxMidiOutDevice.html">wxMidiOutDevice</a>* pMidiOut = <span class="keyword">new</span> <a class="code" href="classwxMidiOutDevice.html">wxMidiOutDevice</a>(0);</div>
<div class="line">pMidiOut-&gt;<a class="code" href="classwxMidiOutDevice.html#aa680213719b21408394e0e2e27e4df48">Open</a>();</div>
</div><!-- fragment --></li>
<li>Prepare the message to send <div class="fragment"><div class="line"><a class="code" href="classwxMidiShortMessage.html">wxMidiShortMessage</a> msg(0x90, 60, 127);</div>
</div><!-- fragment --></li>
<li>Send it:</li>
</ol>
<div class="fragment"><div class="line">pMidiOut-&gt;<a class="code" href="classwxMidiOutDevice.html#a9d2dc3ef315d9c571a0210c5303cf1b8">Write</a>(&amp;msg);    </div>
</div><!-- fragment --><p>For very common messages, such as Note On or Note Off, steps 3 and 4 can be replaced by a call to the suitable method. For example: </p>
<div class="fragment"><div class="line"><span class="comment">//Play a scale </span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> scale[] = { 60, 62, 64, 65, 67, 69, 71, 72 };</div>
<div class="line"><span class="keywordtype">int</span> K_SCALE_SIZE = <span class="keyword">sizeof</span>(scale) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>);</div>
<div class="line"><span class="keywordtype">int</span> channel = 0, volume = 127;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; K_SCALE_SIZE; i++)</div>
<div class="line">{</div>
<div class="line">    pMidiOut-&gt;<a class="code" href="classwxMidiOutDevice.html#a4fc5c3a252d53cef58c5a690bcd39a58">NoteOn</a>(channel, scale[i], volume);</div>
<div class="line">    ::wxMilliSleep(200);    <span class="comment">// wait 200ms</span></div>
<div class="line">    pMidiOut-&gt;<a class="code" href="classwxMidiOutDevice.html#aa17323608c10e93792d85794cf438049">NoteOff</a>(channel, scale[i], volume);    </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="main_receive"></a>
Receiving messages</h1>
<p>The procedure is, basically, the same than for sending messages. The main diference is that in reception the user program does not conthol when the message is going to be received, so a method to be informed about the arrival of a message is needed. wxMidi provides two alternatives for this:</p>
<p><b>By using events and an event handler method</b></p>
<p>By defining an event handler method, the user program will be informed when a message has been received and will have the opportunity to process it. A commnad event with ID named wxEVT_MIDI_INPUT is defined in the <a class="el" href="wxMidi_8h.html" title="The only header file for wxMidi. ">wxMidi.h</a> include file. The application program must request from the MIDI device to start listening by calling method StartListening() as in following example:</p>
<div class="fragment"><div class="line">BEGIN_EVENT_TABLE(MyFrame, wxFrame)</div>
<div class="line">...</div>
<div class="line">EVT_COMMAND (ID_MY_PANEL, wxEVT_MIDI_INPUT, MyFrame::OnMidiReceive)</div>
<div class="line">...</div>
<div class="line">END_EVENT_TABLE()</div>
<div class="line"></div>
<div class="line">MyFrame::MyFrame(...)</div>
<div class="line">{</div>
<div class="line">    ....</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Filter out active sensing messages (0xFE) and </span></div>
<div class="line">    <span class="comment">//clock messages (0xF8 only)</span></div>
<div class="line">    m_pInDev-&gt;SetFilter(<a class="code" href="wxMidi_8h.html#a041f3724808836e35422c7fe47c2e61cae37e9355ec7dec540fb5a9a83e154a77">wxMIDI_FILT_ACTIVE</a> | <a class="code" href="wxMidi_8h.html#a041f3724808836e35422c7fe47c2e61ca57230052f3fb957ba8165a3dd5c97f7b">wxMIDI_FILT_CLOCK</a>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// empty the buffer after setting filter, just in case anything</span></div>
<div class="line">    <span class="comment">// got through</span></div>
<div class="line">    m_pInDev-&gt;Flush();</div>
<div class="line"></div>
<div class="line">    <span class="comment">//now start a listening thread. An event wxEVT_MIDI_INPUT</span></div>
<div class="line">    <span class="comment">//will be produced when new input is detected</span></div>
<div class="line">    m_pInDev-&gt;StartListening(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> MyFrame::OnMidiReceive(wxCommandEvent &amp;event)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// loop to read and process all available msges.</span></div>
<div class="line">    <a class="code" href="wxMidi_8h.html#a5608993d09bebfed877d40f47147c790">wxMidiError</a> nErr;</div>
<div class="line">    <a class="code" href="classwxMidiMessage.html">wxMidiMessage</a>* pMsg;</div>
<div class="line">    <span class="keywordflow">while</span> (m_pInDev-&gt;Poll())</div>
<div class="line">    {</div>
<div class="line">        pMsg = m_pInDev-&gt;Read(&amp;nError);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//error checking and do something with the read message</span></div>
<div class="line">        <span class="keywordflow">if</span> (!nError) {</div>
<div class="line">    ...</div>
<div class="line"></div>
<div class="line">    <span class="comment">//delete message when no longer needed</span></div>
<div class="line">    <span class="keyword">delete</span> pMsg;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">MyFrame::~MyFrame()</div>
<div class="line">{</div>
<div class="line">    ....</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Stop the lisening thread</span></div>
<div class="line">    m_pInDev-&gt;StopListening(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>By polling</b></p>
<p>Alternatively, the user application could interrogate the MIDI device, from time to time, to see if a message has been received and, in that case, read and process it. See an example of this in sample program <b>midisound</b>.</p>
<p>See also:</p>
<ul>
<li><a class="el" href="midi_messages.html">MIDI messages representation</a></li>
<li><a class="el" href="wxMidi_8h.html#filter_codes">filter_codes</a></li>
<li><a class="el" href="wxMidi_8h.html#error_codes">error_codes</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jan 10 2015 10:19:43 for wxMidi - A MIDI interface based on PortMidi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
